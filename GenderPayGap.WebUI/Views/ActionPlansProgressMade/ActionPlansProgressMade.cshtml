@using GenderPayGap.Core.Helpers
@using GenderPayGap.WebUI.Views.Components.StatusMessages
@using GovUkDesignSystem
@using GovUkDesignSystem.GovUkDesignSystemComponents
@using Microsoft.AspNetCore.Mvc.TagHelpers
@model GenderPayGap.WebUI.Models.ActionPlans.ActionPlansProgressMadeViewModel

@{
    string encryptedOrganisationId = Encryption.EncryptId(Model.Organisation.OrganisationId);
    string formattedReportingYears = ReportingYearsHelper.FormatYearAsReportingPeriod(Model.ReportingYear);

    ViewBag.Title = $"Action plan - reporting year {formattedReportingYears} - {Model.Organisation.OrganisationName} - Gender pay gap service";
}

@section BeforeMain {
    @{
        var crumbs = new List<CrumbViewModel>
        {
            new CrumbViewModel
            {
                Text = "Manage Employers",
                Href = Url.Action("ManageOrganisationsGet", "ManageOrganisations")
            },
            new CrumbViewModel
            {
                Text = Model.Organisation.OrganisationName,
                Href = Url.Action("ManageOrganisationGet", "ManageOrganisations", new {encryptedOrganisationId})
            },
            new CrumbViewModel
            {
                Text = $"{formattedReportingYears} Reporting year",
                Href = Url.Action("ReportOverview", "ReportOverview", new { encryptedOrganisationId, reportingYear = Model.ReportingYear})
            },
            new CrumbViewModel
            {
                Text = "Action plan"
            },
            new CrumbViewModel
            {
                Text = "Progress made"
            }
        };
    }

    @(await Html.GovUkBreadcrumbs(new BreadcrumbsViewModel
    {
        Crumbs = crumbs
    }))
}



<form method="post"
      action="@Url.Action("ActionPlansProgressMadePost", "ActionPlansProgressMade", new { encryptedOrganisationId, reportingYear = Model.ReportingYear})">
      @(Html.AntiForgeryToken())
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            @(await Html.GovUkErrorSummary(ViewData.ModelState))

            <h1 class="govuk-heading-xl govuk-!-margin-bottom-6">
                Action plan
                <br/>
                <span class="govuk-!-font-size-27 govuk-!-margin-top-3" style="display: inline-block; line-height: 1.3 !important;">
                    Reporting as @(Model.Organisation.OrganisationName)
                    <br/>
                    for snapshot date
                    @(Model.Organisation.SectorType.GetAccountingStartDate(Model.ReportingYear).ToString("d MMMM yyyy"))
                </span>
            </h1>
        </div>
    </div>
    
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            
            <fieldset class="govuk-fieldset">
                @(await Html.GovUkTextInputFor(
                    m => m.ProgressMade,
                    labelOptions: new LabelViewModel {Text = "What progress have you made this year?", IsPageHeading = true},
                    formGroupOptions: new FormGroupViewModel {Classes = "govuk-!-margin-bottom-2"},
                    classes: "govuk-input--width-20"
                    ))

            </fieldset>

            @(await Html.GovUkButton(new ButtonViewModel
            {
                Text = "Save and continue",
                Classes = "govuk-!-margin-bottom-6"
            }))

        </div>
    </div>
    
</form>
